#
spring:
  cloud:
    gateway:
      enabled: true
      #（★）
      discovery:
        locator:
          enabled: true
          lower-case-service-id: true
      #（★）http连接
      httpclient:
        pool:
          #Only for type FIXED
          max-connections: 5000
          acquire-timeout: 5000
          #
          max-idle-time: 1000
          max-life-time: 1000
        #连接和读取超时
        connect-timeout: 5000
        response-timeout: 5000
      #（★）全局过滤器
      default-filters:
        - StripPrefix=1
        - name: Hystrix
          args:
            name: default
            fallbackUri: forward:/defaultFallback
      #（★）路由
      routes:
        - id: study-springcloud-provider
          #目标服务地址，lb代表从注册中心获取服务，且以负载均衡方式转发
          uri: lb://study-springcloud-provider
          #路由条件
          predicates:
            - Path=/study-springcloud-provider/**
          #过滤规则
#          filters:
#            - StripPrefix=1
#            #（▲）熔断
#            - name: Hystrix
#              args:
#                name: default
#                fallbackUri: forward:/defaultFallback
            #（▲）限流
#            - name: RequestRateLimiter
#              args:
#                #
#                key-resolver: '#{@remoteAddrKeyResolver}'
#                #每秒最大访问次数
#                redis-rate-limiter.replenishRate: 20
#                #令牌桶最大容量
#                redis-rate-limiter.burstCapacity: 20
